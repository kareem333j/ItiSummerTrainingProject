{% extends 'layout/base.html' %}
{% load static %}

{% block title %} Categories {% endblock title %}
{% block content %}
<div class="w-100 pt-5" style="min-height: 90vh;">
    {% for msg in messages %}
    <div class="w-100">
        <div class="alert alert-success alert02" role="alert">
            {{msg}}
        </div>
    </div>
    <script>
        const alert02 = document.querySelector('.alert02');
        setTimeout(()=>{
            alert02.remove();
        }, 5000);
    </script>
    {% endfor %}
    <div class="row d-flex justify-content-center align-items-center mb-3">
        <h3 class="text-start text-light fw-bold col-lg-12" style="font-size: 2.2em;"> Categories : </h3>
    </div>
    {% if books.count == 0 %}
    <p class="w-100 text-center text-danger d-flex justify-content-center align-items-center" style="font-size: 1.3em;min-height: 30vh;">No book has been downloaded yet :)</p>
    {% else %}
    <div class="w-100 d-flex justify-content-center p-0 align-items-center">
        <table class="table1 w-100">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Title</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for category in categories %}
                <tr>
                    <td>{{category.id}}</td>
                    <td>{{category.title}}</td>
                    <td>
                        <div class="d-flex gap-3">
                            <a class="btn btn-primary" href="{% url 'categories.edit' category.id %}"><i class="fa-solid fa-pen-to-square"></i></a>
                            <button data-category="{{category.id}}" class="btn btn-danger delete-category" href="#"><i class="fa-solid fa-trash"></i></button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
    <div class="d-flex gap-1">
        <a href="{% url 'categories.add' %}" class="btn btn-success mt-4 ms-1">Add <i class="fa-solid fa-plus"></i></a>
    </div>
</div>
<script>
    if(document.querySelectorAll('.delete-category')){
        const deleteBtn = document.querySelectorAll('.delete-category');
        [...deleteBtn].map((btn)=>{
            btn.addEventListener('click', (e)=>{
                Swal.fire({
                    title: "Are you sure?",
                    text: "You want to delete this category!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Yes, delete it!"
                }).then((result) => {
                if (result.isConfirmed) {
                    category_id = e.target.getAttribute("data-category");
                    window.location.replace(`/books/categories/delete/${category_id}`)
                }
                });
            });
        });
    }
</script>
{% endblock content %}